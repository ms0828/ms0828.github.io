---
title: "[C++11, C++14] 람다표현식"
excerpt: "람다 사용하기"

categories:
  - C/C++
tags:
  - [c,cpp]

permalink: /categories/c/lambda

toc: true
toc_sticky: true

date: 2024-01-26
last_modified_at: 2024-01-26
---
## 람다표현식(Lambda)
함수 객체를 클래스 정의 없이 만드는 방법으로, 람다식을 사용하면 함수 객체나 함수 포인터가 필요한 부분에 익명 함수를 쉽게 만들어 사용할 수 있다.

> 람다식을 사용하면 함수 객체를 인라인으로 생성할 수 있기 때문에, 함수 호출에 대한 오버헤드를 줄이고 코드를 간결화 할 수 있다.

_함수 인라인화 : 함수 호출 오버헤드(Cpu가 함수 주소로 Jump하여 함수를 실행했다가 다시 원래 주소로 돌아오는 과정)를 줄이기 위해 컴파일러가 함수 실행 부분에 해당 함수 본문을 직접 삽입하는 것을 말함_

<br>

## 사용 방법
람다표현식은 다음과 같은 형태를 취한다.<br>
\[캡처\] (매개변수 선언) {함수 본문} (호출 시 인자)
<br>

1. \[캡처\] : 캡처 방식 선언 부분
2. (매개변수 선언) : 함수 매개변수 선언 부분 (없으면 생략가능)
3. {함수 본문} : 함수 로직을 정의하는 부분
4. (호출 시 인자) : 함수 호출 시 전달할 인자 부분 (함수를 정의할 때는 사용x, 함수 호출 시 사용)

간단한 예제로 보면 다음과 같다.
```
#include <iostream>
using namespace std;
int main() {
    int x = 10;
    int y = 20;

    cout << "x와 y의 합은 : " << [](int x, int y) {return x + y; }(x, y) << endl;

    return 0;
}
```

<br>

### 캡처 사용법
람다식 첫번째 \[\] 부분인 **캡처**를 사용하면 바깥쪽 스코프에 있는 외부 변수를 캡처하여 람다식 내부에서 사용할 수 있다.<br>
* 괄호 안에 들어가는 기호에 따라 외부 변수를 어떤 방식으로 캡처할 수 있는지 선택할 수 있다.

1. \[\] : 외부 변수를 사용하지 않음
2. \[=\] : 모든 외부 변수를 값 복사로 사용
3. \[&\] : 모든 외부 변수를 참조 형식으로 사용
4. \[변수이름\] : 지정한 외부 변수를 값 복사로 사용
5. \[&변수이름\] : 지정한 외부 변수를 참조 형식으로 사용


<br>
코드로 보면 다음과 같다.

```
#include <iostream>
using namespace std;
int main() {
    int x = 10;
    int y = 20;

    //람다식에서 외부 변수를 사용하지 않음
    //cout << "1 : " << []() {return x + y; }() << endl;   // <- 컴파일 에러

    //람다식에서 외부 변수 x, y를 값 복사로 사용
    cout << "2 : " << [=]() {return x + y; }() << endl;

    //람다식에서 외부 변수 x, y를 참조로 사용
    cout << "3 : " << [&]() {
            int temp = x;
            x = y;
            y = temp;
            cout << "x :" << x << ", y : " << y << endl;
            return x + y; 
        } () << endl;

    //람다식에서 외부 변수 x,y만 값 복사로 사용
    cout << "4 : " << [x, y]() {return x + y; }() << endl;

    //람다식에서 x는 참조, 나머지 모든 외부 변수는 값 복사로 사용
    cout << "5 : " << [=, &x]() {return x + y; }() << endl;

    return 0;
}
```
